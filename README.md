# non-local_cortex_simulation
The simulation tests the electrophysiology of the cortex can be modeled by a particular non-local energy exchange field based on an oscilator network



#
# Tutorial: The "non-local brain" simulation

# Setting things up

The "non-local brain" simulation is executed in NetLogo using the file _ **neoNoLIP\_xxx.nlogo.** _

The tutorial explains our program written in _NetLogo_ language. It shows versatile applications of our software and how we model different information transmission processes in the brain. Moreover, our software can directly visualize emergent phenomena in neuron populations (e.g., in the visual cortex). Such populations are generated by defining simple and basic rules for each neuron.

## Use cases and examples demonstrate the simulation further

### Interface and examples

### This allows us to modify any of the simulations easily. Follow these steps:

Open _ **neoNoLIP\_xxx.nlogo.** _

This will display an Interface (Fig. T1)

![](RackMultipart20240102-1-5hbr6t_html_a75c4542871e9ae4.png)

![image](https://github.com/josef-streusalz/non-local_cortex_simulation/assets/53902418/89e402cf-db59-4a46-a03b-f713b43e1f34)
**Figure T1:** Interface of simulation. Elements are: the visualization of activation levels (1), the generation of the rhythmic local field potentials (2), a section to alter the visualization (3), sliders to influence the symmetry of energy transfer (4), a section for adjusting the basic properties of energy transfer, such as damping, number of neighbors, slope (5), parameters to determine the signal length (6), parameters to simulate inhibitory neurons (7), a generator for spontaneous activity (8), simulators for Alzheimer's disease (9) and schizophrenia (10), as well as the output panel for the depicted signals (11).

The following figures will describe the highlighted feature of the interface seen in Fig. T1 in more detail.

The main screen visualizes the simulation. The top slider (Fig. T1.1) named '_coloringactivation_' literally translates the _activation0 level_ in color code. Furthermore, the _tick counter_ displays the number of _ticks_ or _calculation steps_ that symbolize _milliseconds_ (red circle).

![Shape1](RackMultipart20240102-1-5hbr6t_html_b4aa4763521f19b3.gif) ![](RackMultipart20240102-1-5hbr6t_html_1920536e5917d819.png)


![image](https://github.com/josef-streusalz/non-local_cortex_simulation/assets/53902418/38bed7c6-2e16-4bca-bc6a-5609e5ba84c0)
**Figure T1.1:** Slider for coloring activation.

A basic property of the simulation of the cortical area is that energy input can enter the model everywhere, with different energy levels and distinct frequencies. Fig. T1.2 demonstrates the parameters that can be altered to set up and fine-tune the input. Aside from this, even more complex signals or chaotic signals can enter the processing layer of neurons. For this purpose, an input can manually be set, e.g., to generate phenomena like k-complex.

Fig. T1.2 shows buttons and sliders where you can 'initialize' the simulation and let it run 'stepwise' or 'automatically'. Furthermore, you can define different inputs (_input1 – 12),_ with defined frequencies (_signal1 – 12_), and signal strengths and set their coordinates (_xcor, ycor_). There is an additional _Carrier__signal_ and a _Fire_ button that allows you to manually set the input. Moreover, _the level of input activation_ is changed by sliders that allow you to define the _input activation_ of _input1-12, Fire,_ and the carrier signal.

| ![](RackMultipart20240102-1-5hbr6t_html_cbdeed0cf155fa14.jpg)… |
| --- |
| ![](RackMultipart20240102-1-5hbr6t_html_e0f92ce4f6b0d656.jpg) |

![image](https://github.com/josef-streusalz/non-local_cortex_simulation/assets/53902418/4217a546-00bc-4aca-8788-8fde2aec0cb2)
![image](https://github.com/josef-streusalz/non-local_cortex_simulation/assets/53902418/748b232f-2482-41b0-aa20-54c878be5dce)

**Figure T1.2:** Demonstration of _sliders_ and _switches_ for editing the input signals of the simulation. The input signals have a defined strength, a distinct or dynamic localization, are rhythmic or chaotic, can be coded in prime numbers, affect a certain number of neighbors, and are generated manually _(Fire)_.

For the purpose of developing a qualitative impression of the interference patterns, the properties of the visualization of the communicating neuronal columns are altered by several 'switches' and 'slider'. In addition, the recording electrodes can be shown, and their size and position can be adapted to the object of the investigation.

![](RackMultipart20240102-1-5hbr6t_html_fc1de273333b343.png)

![image](https://github.com/josef-streusalz/non-local_cortex_simulation/assets/53902418/d39cf442-1c5f-49f5-8997-013e14a2d3e5)

**Figure T1.3:** The graphical appearance is changed with the switches and the sliders, such as _'backgroundcolors'_ and '_margincolor'_. An upper and lower range of activation can be selected for focusing distinct energy levels. Otherwise, the visualization is dynamically adapted to the maxima and minima. In addition, the recording electrodes are visualized on demand, and their positions are selected.

Fig. T1.4 shows various sliders that enable the user to alter the _wave direction_ in our simulations of neuronal waves. The sliders are ordered according to how the signal is transmitted from a node to its neighbors (e.g. _rr_ = 1: information is transmitted to the right-right neighbors multiplied by 1; _or_ – upright neighbor; _uul_ – lower-lower-left neighbor). By modifying the settings, you can verify that the waves are reacting very sensitively to changes. The alteration of symmetry causes interesting phenomena with complex geometries that not only have regular patterns in space but also in time. Aside from the precise symmetrical information processing, gentle symmetry breaking increases the degrees of freedom of the simulation and offers new ways to analyze a system's behavior facing external information.

![](RackMultipart20240102-1-5hbr6t_html_42e7879650c68629.png)
![image](https://github.com/josef-streusalz/non-local_cortex_simulation/assets/53902418/8ea1c682-1116-498d-bc40-1161896e71db)
**Figure T1.4:** Alter the symmetry of energy transfer for your purposes. The sliders are in a retinotopic order related to the neighbors of neurons that are exited.

Furthermore, Fig. T1.5 presents _sliders_ that offer you options to alter the properties of energy transfer between the patches. In order to simulate the transmission of energy between the patches, the neighbors are ordered radially symmetric around one patch. _Neighbourintergration_ determines the ratio of energy a neighbor contributes with its own activation to the activation of the central patch. _Neighbourintegration_ is the ratio of energy transfer of the 4 next neighbors, whereas _neighbourintegration1_ is the ratio of the 4 next-next neighbors and _neighboursintegration2_ of the 4 next-next-next neighbors, and so on. Overall, 60 neighbors can be set to contribute to the calculation of the present slope and the corresponding activation level. In this way, the activation of the patches is calculated step by step for each tick. Similar to an increase in _neighbourintegration_ (_NI\_slopev_) an increased connectivity can increase the speed of waves and frequency coding potential.

![](RackMultipart20240102-1-5hbr6t_html_f5960e1ae13e65f3.png)

![image](https://github.com/josef-streusalz/non-local_cortex_simulation/assets/53902418/398eec65-e0a3-4ebd-b302-e0a4b080b310)
**Figure T1.5:** The properties of the energy transfer can be altered by adjusting the energy transfer between the patches (_neighbourintegration_). An altered energy transfer in time and space will influence the appearance of the interference pattern of the waves the model generates. The number of neighbors contributing to the calculation of activation affects the speed of the waves, the wave pattern, and the frequency space.

The creation of an interference pattern of different input frequencies in the wave-like brain model requires time. As the model is simulating non-local information processing, the supply of each patch with the entire input information requires time dependent on the wave speed and the model's size. Moreover, the _fft_ is performing better with increasing the length of the signal. Hence, there is a minimum period a model runs to enable investigation of the phenomena of interference. Furthermore, there is a limitation in the length of the signal due to the processing in short data packages. Smaller data packages with similar bandwidth as longer data packages can process more bits in the same period. Therefore, the regulation of the processing period and the period of processing without input at the beginning and the end of the simulation is crucial (Fig. T1.6).

![](RackMultipart20240102-1-5hbr6t_html_c4e8a330a792ac5a.png)

![image](https://github.com/josef-streusalz/non-local_cortex_simulation/assets/53902418/7b8dc20d-fa7c-4d05-8027-192a5420f818)
**Figure T1.6:** The signal length, as well as the start of energy input and end of energy input, can be determined with the sliders shown.

Fig. T1.7shows options to implement the balance of excitatory and inhibitory neurons in the model. Excitatory integration of neighbor energy is balanced by inhibitory neurons, as otherwise, the energy is constantly increasing, and the model collapses. There are the sliders _damping (1), marginextradamping (2), slopev\_damping (3), NI\_slopev (4), slopeo\_damping (5), NI\_slopeo (6), ratio\_neighbour\_activation (7), ratio\_inhibition\_activation1 (8)._ According to the mathematical description of the model, there are several steps in the main algorithm that can be influenced. Most important is the integration of the neighboring energy that is set here to 2.65 (_NI\_slopev_). A value \>=2.7 will exponentially increase energy and frequency and cause the processing to collapse. With an increasing number of neighbors, that value has to be adjusted. However, close to the maximum of _NI\_slopev,_ the generation of frequencies close to the Nyquist frequency is permitted. _Slopev\_damping_ has the reciprocal effect as _NI\_slopev_. This is also valid for _NI\_slopeo_ and _slopo\_damping_.

The inhibition of _slopeo_ is a damping of integrated _slopev,_ and damping is the inhibition of integrated _slopeo_. The regulation of _slopev_ is variable, although a _NI\_slopeo_ \> 1 accompanied by a _slopeo\_damping_ of 1, or a damping \< 0 both result in amplification of energy and system collapse. The described systems collapse that is linked to exceeding distinct borders of ratios of inhibitory and excitatory neurons resembles the signaling pattern of epilepsy.

Frequency coding is very stable. Changing the balance between excitatory and inhibitory neurons can ensure stable frequency processing. Most of those modulatory functions described in Fig. T1.7 constantly convolute the processed function. As long as the ratios of convoluting functions stay constant during a coding period, the frequency-coded signals are equally modulated, and the relations of energy change stay the same. Yet, a time-dependent change of the modulatory function can alter coding packages differently and shift the frequency.

Required are then some further changes, as the decrease of the _NI\_slopev_ functions acts like a lowpass filter. Decreasing the ratio of_ratio\_neighbour\_activation and ratio\_inhibition\_activation1_, simulates the increase of inhibitory neuron activity and likewise increases gamma firing.

![](RackMultipart20240102-1-5hbr6t_html_b181fb66e54846e8.png)
![image](https://github.com/josef-streusalz/non-local_cortex_simulation/assets/53902418/9aa60697-fe40-4b38-ac73-73275838b2f8)
**Figure T1.7:** The modulation of the balance of excitatory and inhibitory neurons is crucial for describing different system states of the brain, like slow wave sleep, waking, and active processing. Furthermore, diseases like schizophrenia, epilepsy, or autism may have their origin in the intervention of those balances.

Like inhibition, the spontaneous activity of neurons is also a complex phenomenon. Spontaneous activity is distributed across the cortex and appears noisy. However, the role of spontaneous activity is not fully understood 1. In this model, you can implement this finding by activating the button _spontaneousactivity_ and defining the ratio of spontaneously activated cells _(ratio\_activatedcells_) and the extent of noise that they are generating (_spontaneousact_). A functional example is shown in Fig. T1.8. Spontaneous activity is applied for analyzing the baseline.

![](RackMultipart20240102-1-5hbr6t_html_e888f4b1b3d5c80a.png)
![image](https://github.com/josef-streusalz/non-local_cortex_simulation/assets/53902418/0114d51c-c0ea-4da2-81e2-3dd7236c7974)

**Figure T1.8** : Generate spontaneous activity of neurons within a neuronal column. Basically, the implementation of spontaneous activity mainly generates different kinds of noise or full randomness, whereas a rhythmic spontaneous activity should not be excluded. Furthermore, spontaneous activity is defined by the ratio of activated cells in each processing step and the level of activation.

### Modelling transmission failure and different diseases

The model allows the simulation of different types of transmission failure, mimicking some key features in Alzheimer's disease and schizophrenia. The simulation for Alzheimer's disease (Fig. T1.9)is based on an algorithm that is setting random neurons to death (inactivating random neurons) – called lesions (_defects_ in Fig. T1.9). These lesions can grow by increasing the _threshold2_. The algorithm is built according to the description of the development of lesions during the different stadia of Alzheimer's disease_2,3_. The ratio of defects should be set up before initializing the model. After initialization, the lesion can be extended by activating the _cluster_ button and increasing the _treshold2_ slider_._ Before starting the simulation, you should push _Reset Ticks._ With the switches _showLesions_ and _regular,_ one can decide to show defects or set them in a regular order.

![](RackMultipart20240102-1-5hbr6t_html_944e08a66a1dd9fb.png)
![image](https://github.com/josef-streusalz/non-local_cortex_simulation/assets/53902418/b57860fa-ede2-461f-9d3c-b7d30318532d)

**Figure T1.9:** Simulating stochastic failure of neurons (Alzheimer's disease).

The schizophrenia simulation focuses in its basic version on the correlation problems of neurons, which may be due to a deceleration of dendritic and axonal signaling because of a lack of myelin code or other cytoskeleton impairments 4-7. The correlation problems of signaling between the neurons can occur in the synapse, dendritic, axonal, or supporting cell level 3,8-10 and are related to complex genetics 11. Nonetheless, in electrode recording, especially EEG recording, we can find an altered complexity of the signaling pattern, indicating that the balance of Glutamate and GABA is shifted, as well as the relation of beta and delta band is declined3,8,9. The schizophrenia simulation is realized by increasing the ratio of _uncorrelated_ (Fig. T1.10). The correlation problems randomly affect a distinct percentage of columns in the simulation. Similar to the various effects of _neighbourintegration_ and its relation to damping, correlation problems can occur on different integration levels of the algorithm. In this way, the transmission of the activation1 of the neighbors (_uncorrelated, uncorrelated2_), the _slope\_vector_ (_uncorrelated3\_slopev_), the _slope\_old_ (_uncorrelated4\_slopeo_), or the internal energy duplication (_uncorrelated1_) can be affected. The signal transmission can be totally impaired (_uncorrelated_) or randomly down and upregulated to a distinct percentage range (_ratio\_transmitted\_energy_). Besides the excitatory influence, the inhibition can also be influenced (_uncorrelated3\_slopevdamping, uncorrelated4\_slopeoddamping, uncorrelated5\_damping_). This displays a variety of possibilities for how a Schizophrenia model can influence the non-local cortex simulation, as displayed in Fig. T1.10. It can be investigated how correlation problems affect signal processing and which integration level is related to phenomena, such as the beta band decline12-17. Furthermore, uncorrelated signal transmission at various integration levels of the neuronal circuit could support the understanding of the complexity of schizophrenia.

![](RackMultipart20240102-1-5hbr6t_html_eb64c7da3a349c33.png)
![image](https://github.com/josef-streusalz/non-local_cortex_simulation/assets/53902418/8a7e0c0c-c838-4ef5-9e91-79d4efdcc653)

**Figure T1.10:** Low correlation of signal transmission to neighbor neurons: simulating schizophrenia.

### Output

T ![](RackMultipart20240102-1-5hbr6t_html_135fef2b0301cdb4.png)
 he output of the simulation can simulate different detection methods. Thus, the output window (see Fig. T1.11) contains 6 _plots_ for displaying _MEA_ (multiple electrode array) read-out waves and 6 _plots_ for EEG waves (4 not shown). 6 _MEA_ electrodes are implemented to compare the measured output's time, amplitude, and phase differences. The 6 _EEG_ windows allow comparison of EEG recordings from several locations. The slider _finish_ determines the number of ticks, after which the simulation stops.
![image](https://github.com/josef-streusalz/non-local_cortex_simulation/assets/53902418/205090af-1666-48a8-8c9f-b461b9539b57)

**Figure T1.11:** Output according to MEA recordings (1) and EEG readings (2). Furthermore, it can be adjusted how long the simulation will run (3).

## Analysis Examples

### Matlab Analysis

After running the simulation for 4100 _ticks_ (time steps),the information of the plots - _x_-_value_ and _y-values -_ are stored in 12 _CSV-files_ in the _PackageNetlogo folder_, named _wavepattern00.csv, wavepattern11.csv, wavepattern22.csv, wavepattern33.csv, wavepattern44.csv, wavepattern55.csv and eegsignbal1-6.csv._ There are example output files in the _PackageNetlogo/Output_ folder. With the Matlab files _avalancheanalysis.m_, _fft\_peak\_analysis.m_, _stFT.m,_ and _coherence.m_ several basic analyses used in the paper can be executed.

### Wave interference

The output window shown in Fig. T1 gives qualitative evidence of the processing of the model. In the example in Fig. T2 there are 2 external (red stars) and 3 internal stimuli (blue stars) represented and their interference pattern after 20, 50, 100, 150, 200, and 250 ms. Stimuli from the different sensory organs can enter the model at any location of the model. The internal and external stimuli are copied, statistically processed, compared to existing information, and integrated. Consequently, the entered information is distributed over the whole model, making it available in any column after a distinct period. External and internal stimuli generate a complex interference pattern; if not indexed, those stimuli are indistinguishable on the level of non-local information processing. It is not clear whether information is lost, modulated, or translated in the model. However, the bordering conditions and the damping greatly influence the maintenance of detecting frequency-coded input.

![](RackMultipart20240102-1-5hbr6t_html_86c0a741f7215b25.png)
![image](https://github.com/josef-streusalz/non-local_cortex_simulation/assets/53902418/b3949f3a-9242-4d09-b20e-134678dfc6d0)

**Figure T2** : Wave pattern is formed by symmetrical interaction of neighbors. Red stars indicate external input, while blue stars indicate internal input. The pictures are made at 20, 50, 100, 150, 200, and 250 ms after stimulus onset. Processing of information is time-dependent. Hence, the information spreads over the whole model. Fully integrated information can be depicted from each location. The information can be coded in harmonics and phase by means of the complex interference pattern. With an FFT, the input information can be decoded. The frequency coded depends on, e.g., the definition of sampling rate, wave speed, wavelength, space, and time.

### Frequency Analysis

For the functional analysis of data, run Matlab.After that, go to the _PackageNetlogo_ folder. Type in the Matlab command line: _fft\_peak\_analysis\_sub.m and show\_signal\_sub.m__ **.** _ This will start a Matlabscript that runs a Perl parser that compiles the _CSV_ filesand imports them to Matlab variablesfor the purpose of plotting MEA plots and EEG plots with a running average. On top of this, the data are analyzed with a Matlab-implemented Fourier transform of each dataset. We show the output of the fft-analysis: The 8 plots generated by the script _fft\_peak\_analysis\_sub.m_ are saved in the 8 figures that you can find in the _PackageNetlogo_ folder.

Fig. T3 shows an example of 3 plotted original recorded MEAwith running average_._ The MEA consists of 6 electrodes in the model of distinct locations (MEA1: x=30,y=30; MEA2 x=30,y=80; MEA3: x=30, y=90; MEA4: x=80,y=30; MEA5 x=80,y=80; MEA6: x=80, y=90).

The input is peak-like, which means that a signal of input 120 mV is applied at distinct time steps. 8 neighbors are contributing to the model with a _NI\_slopev_ of 1.2. The _marginextradamping_ is 0.5, and the input signal strength is 120 mV. The simulation ran 4100 ms, with a period of 3000 ms of constant input. The inputs are 13, 17, 23, 29, 31, 37, 41, 43, 47, 53, 59 and 61 Hz. The input locations are random. The presented signal is 1000 ms in length. Fig. T3 gives a qualitative overview of the MEA recording and indicates differences that occur despite processing unified input.

![](RackMultipart20240102-1-5hbr6t_html_55cd9c2803550b8c.png)

![](RackMultipart20240102-1-5hbr6t_html_41a899b509b2da92.png)

![](RackMultipart20240102-1-5hbr6t_html_5fa7be9c75ef1588.png)
![image](https://github.com/josef-streusalz/non-local_cortex_simulation/assets/53902418/a9467bdb-c6fe-49cd-99ee-2f6f6168890b)
![image](https://github.com/josef-streusalz/non-local_cortex_simulation/assets/53902418/0219b1f7-1688-45da-8482-57609485e1b7)
![image](https://github.com/josef-streusalz/non-local_cortex_simulation/assets/53902418/260e30bf-1646-4b77-b920-110b070eee19)

**Figure T3:** 3 MEA-plots of different locations of a signal created by the simulationdisplaying a section of 1000 ms_._ Each single electrode of the MEA is recording an LFP summarizing input of ~500 µm, corresponding to a neuronal column. The original signal is in black. The running average is marked in red. The wave pattern is created by 12 inputs with peak inputs of 13, 17, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61 Hz. The location of MEA1 is x = 30 and y = 30, of MEA2 is x = 30 and y = 80, and of MEA3 is x = 30 and y = 130.

Analog to the parameters described above, an EEG pattern is simply generated by integrating all patches in a radius of 10 mm from the EEG location. The central locations of the 6 EEG signals are the same as the MEA electrodes (EEG1: x=30,y=30; EEG2 x=30,y=80; EEG3: x=30, y=90; EEG4: x=80,y=30; EEG5 x=80,y=80; EEG6: x=80, y=90). In Fig. T4, examples of the EEG recording are presented, and the moving average is added in red.

![](RackMultipart20240102-1-5hbr6t_html_aa9c28f3e4ecf2b1.png) ![](RackMultipart20240102-1-5hbr6t_html_110427ed5e2676f6.png)
![image](https://github.com/josef-streusalz/non-local_cortex_simulation/assets/53902418/0b505af6-c899-45a0-a271-666ceb6e45a0)
![image](https://github.com/josef-streusalz/non-local_cortex_simulation/assets/53902418/ee5c01d3-9eb3-4865-b41d-30e5390d16e9)

**Figure T4**** :** 3 EEG plots of different locations of a signal created by the simulation displaying a section of 1000 ms_._ Each single electrode of the EEG is recording a signal integrated over a radius of 20 mm.The original signal is in black. The running average is marked in red. The wave pattern is created by 12 inputs with peak inputs of 13, 17, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61 Hz. The location of EEG1 is x = 30 and y = 30, and EEG3 is x = 30 and y = 130.

Fig. T5 and T6 display the FFT-analysis of the MEA- and EEG-signal shown in Fig. T3 and T4. The peak frequencies that match the 6 different _input periods_ are highlighted with red circles. The frequencies of 142, 91, 76, 58, 52 and 34.5 Hz. As we suggest, frequency coding of the cortex, which agrees well with the topology of the cortex and the non-local simulation, signals are analyzed in frequency space. Interestingly, Fig. T5 shows not only the decoding of the input frequencies (13, 17, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61 Hz), as indicated by blue crosses, but also the presence of overtones of the input signals (green stars). Overtones typically appear when periodic spike input is applied and disappear in the presence of rhythmic sinusoid input. Further parameters for the generation of the input signal are a _NI\_slopev_ of 1.2, _damping_ of 0.03, _mdamping_ of 0.5, synchronous processing, an input strength of 120 mV, and a signal length of 3000 ms. In Fig. T5, only one electrode is presented of a multi-electrode array of 6 electrodes, all measuring the activity of a single processing unit.

![](RackMultipart20240102-1-5hbr6t_html_ffb117f90cc2d118.png)
![image](https://github.com/josef-streusalz/non-local_cortex_simulation/assets/53902418/685a2cc7-218a-49db-9349-94e297a649b6)

**Figure T5** : The example shows the decoding of an electrode signal of 12 input frequencies (blue) with 17 overtones (green) that appear due to the underlying morphology of the model. Red crosses indicate 4 artificial frequencies, or noise, that cannot be differed from the real signal. The parameters are input frequencies of 13, 17, 23, 29, 31, 37, 41, 43, 47, 53, 59, and 61 Hz with an input strength of 120 mV, _NI\_slopev_ of 1.2, _damping_ of 0.03, _mdaming_ of 0.5 and a signal length of 3000 ms.

The parameters for the EEG signal are the same for the electrode recordings. The EEG signal is generated by the integration of neuronal columns within an area of 2 mm (electrode radius). In Fig. T6 there is also the decoding of input signals. However, the amplitudes at low frequencies appear much higher than at the high-frequency band in contrast to the frequency space shown in Fig. T5. In both figures, there is also the appearance of artificial signals (red crosses). These are either real artifacts caused by input or processing or artifacts that are based on the precision or sensitivity of the peak detection function. The frequency analysis is executed by the script _ftt\_peak\_analysis\_sub.m_.

![](RackMultipart20240102-1-5hbr6t_html_9d35096388b14af0.png)
![image](https://github.com/josef-streusalz/non-local_cortex_simulation/assets/53902418/b4871e6f-3284-4525-a0f0-e9f2b1a41914)

**Figure T6** : The example shows the decoding of an EEG signal of 12 input frequencies (blue) with 17 overtones (green) that appear due to the underlying morphology of the model. Red crosses indicate 4 artificial frequencies, or noise, that cannot be differed from the real signal. The parameters are input frequencies of 13, 17, 23, 29, 31, 37, 41, 43, 47, 53, 59, and 61 Hz with an input strength of 120 mV, _NI\_slopev_ of 1.2, _damping_ of 0.03, _mdaming_ of 0.5 and a signal length of 3000 ms.

Analog to constant frequency measurements, the short-time Fourier transform (stFT) gives an impression of the dynamic of processing variable stimuli in time. As the cortex processes stimuli with different lengths and different phases or arrival times, the frequency space gets more complex, and the resolution in time holds more dynamics and biologically relevant information. In Fig. T7, there is an example of a decoded stationary signal of 12 inputs transformed in time Fourier space over 4 seconds. It is evident that the constant signal produces a constant frequency behavior over time. Additionally, the 12 stimuli overtones are again decoded, similarly shown in Fig. T5 and T6. The stFT is executed by the script _stFT\_sub.m_.

![](RackMultipart20240102-1-5hbr6t_html_dd7d393967fe9f08.png)
![image](https://github.com/josef-streusalz/non-local_cortex_simulation/assets/53902418/6163353e-e377-46b8-80c7-1b370e76ce16)

**Figure T7:** Short-time Fourier Transform (stFT) of EEG1 of an integrated signal using the parameter described above. 12 Input frequencies and their overtones can be observed constantly over a period of 3 s. The window size for the stFT is 500 ms, and the sampling rate is 1000 Hz. The wave pattern is created by 12 inputs with peak inputs of 13, 17, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61 Hz. The location of EEG1 is x = 30 and y = 30.

### Avalanche Analysis

The second analysis script written in Matlab – language is named _avalancheanalysis\_sub.m_ **.** It focuses on the analysis of the peaks of the MEA- and EEG-signal. In order to run the script, open Matlab, switch to the PackageNetlogo/ - folder, and type into the _command window: avalancheanalysis\_sub.m._ The script will run a peak identifier and plot the peaks to the signals of the simulation (Fig. T8 & T9).The second part of the script contains a peak counter and a module to calculate a fit curve for the plotted avalanche size (peak size) and its related occurrences (P(s)) (Fig. T10 & T11). The avalanche analysis is utilized for a comparison of the _avalanche analysis_ of the output of the simulationwith a similar analysis of real MEA data published by Ribeiro{Ribeiro, 2010 #2050}18. The size distributions help to estimate parameter values such as _NI\_slopev_, _slopeo\_damping_, _damping_, the _ratio of spontaneous activity_, as well as the input type and strength. Hence, the parameters of the model that are adjusted are major driving forces for switching between the brain states.

![](RackMultipart20240102-1-5hbr6t_html_586bcd4773124464.png)
![image](https://github.com/josef-streusalz/non-local_cortex_simulation/assets/53902418/620f79c3-09f3-4b75-a123-7c55284b911c)

**Figure T8** : MEA-plots with the signal shown in green, running average in red, and identified peaks in red triangles. The signal is created by 5 inputs with a frequency of 7, 11, 13, 17, 19 Hz and a carrier signal with a frequency of 29 Hz.

![](RackMultipart20240102-1-5hbr6t_html_7a67aeee701ff322.png)
![image](https://github.com/josef-streusalz/non-local_cortex_simulation/assets/53902418/99603eec-95a0-4923-ab09-e63b2dcf41b0)

**Figure T9** : EEG-plots with running average in red and peak identifier in red triangles. The signal is created by 5 inputs with frequency of 7, 11, 13, 17, 19 Hz and a carrier signal with a frequency of 29 Hz.

![](RackMultipart20240102-1-5hbr6t_html_234805ac23e5de5d.png)
![image](https://github.com/josef-streusalz/non-local_cortex_simulation/assets/53902418/2e9d3193-30ca-41f6-8fd6-1b037c9acaa1)

**Figure T10** : The avalanche size distribution of MEA signals is indicated in red triangles. The lognormal fit curve is shown as a red line. The power law fit is indicated by a blue line. The signal is created by 5 inputs with frequency of 7, 11, 13, 17, 19 Hz and a carrier signal with a frequency of 29 Hz_._

![](RackMultipart20240102-1-5hbr6t_html_8bd92f19e1549e0e.png)
![image](https://github.com/josef-streusalz/non-local_cortex_simulation/assets/53902418/936be922-946c-4125-9679-2979226dd523)

**Figure T11** : The avalanche size distribution of signals is indicated in red triangles. The lognormal fit curve is shown as a red line. The power law fit is indicated by a blue line. The signal is created by 5 inputs with frequency of 7, 11, 13, 17, 19 Hz and a carrier signal with a frequency of 29 Hz_._

### Coherence Analysis

The coherence analysis is executed by the script _coherence\_sub.m_. The cortex shows distinct coherence profiles when analyzed at different frequencies and different tangentials, as well as radial distances, as described by Maier et al 2014 (see Fig. 3)19 and Srinath and Ray 2014 (see Fig. 1)20. The coherence is degrading by increasing frequency, as well as with tangential distance. Tangential distance measurement, as well as frequency measurements, are suitable for application in the non-local model. In Fig. T12, we show an example of coherence analysis of a signal created by 1% of spontaneously activated neurons. The input is at random locations for each processing step and is 10 mV. The signal is recorded by 6 electrodes at distances of 1 (MEA2), 2 (MEA3), 4 (MEA4), 8 (MEA5), and 16 mm (MEA6) from MEA1. It can be concluded that the coherence is decreasing with distance of electrodes and coherence is declining at high frequencies. However, overall coherence is below 0.6 and is has a maximum at ~50 Hz.

![](RackMultipart20240102-1-5hbr6t_html_53bde4c2c6247f51.png)
![image](https://github.com/josef-streusalz/non-local_cortex_simulation/assets/53902418/6d2b9870-7db0-453b-92d4-37d52d1da690)

**Figure T12:** Coherence is measured for 6 electrodes. The signals are created by simulating spontaneous activity. Electrodes are placed at distinct distances in a linear arrangement. Electrode MEA0 is placed at x = 50 mm and y = 30 mm. The coherence is measured according to the source region MEA0 with distances: 1 mm (MEA1), 2 mm (MEA2), 4 mm (MEA3), 8 mm (MEA4), 16 mm (E5).Parameters: spontaneously activated cells 1% and 10 mV, _NI\_slopev_ 2.6, _damping_ 0.01, _mdamping_ 0.5, synchronous, 6000 ms signal length.

#


## Literature

1 Pena, R. F. O., Zaks, M. A. & Roque, A. C. Dynamics of spontaneous activity in random networks with multiple neuron subtypes and synaptic noise : Spontaneous activity in networks with synaptic noise. _J Comput Neurosci_, doi:10.1007/s10827-018-0688-6 (2018).

2 Braak, H. & Braak, E. Frequency of stages of Alzheimer-related lesions in different age categories. _Neurobiol Aging_ **18** , 351-357 (1997).

3 Perl, D. P. Neuropathology of Alzheimer's disease. _Mt Sinai J Med_ **77** , 32-42, doi:10.1002/msj.20157 (2010).

4 Takahashi, N., Sakurai, T., Davis, K. L. & Buxbaum, J. D. Linking oligodendrocyte and myelin dysfunction to neurocircuitry abnormalities in schizophrenia. _Prog Neurobiol_ **93** , 13-24, doi:10.1016/j.pneurobio.2010.09.004 (2011).

5 Merenlender-Wagner, A. _et al._ Autophagy has a key role in the pathophysiology of schizophrenia. _Mol Psychiatry_ **20** , 126-132, doi:10.1038/mp.2013.174 (2015).

6 Cronenwett, W. J. & Csernansky, J. G. Diving deep into white matter to improve our understanding of the pathophysiology of schizophrenia. _Biol Psychiatry_ **74** , 396-397, doi:10.1016/j.biopsych.2013.07.007 (2013).

7 Ehrlich, S. _et al._ Associations of white matter integrity and cortical thickness in patients with schizophrenia and healthy controls. _Schizophr Bull_ **40** , 665-674, doi:10.1093/schbul/sbt056 (2014).

8 Salavati, B. _et al._ Imaging-based neurochemistry in schizophrenia: a systematic review and implications for dysfunctional long-term potentiation. _Schizophr Bull_ **41** , 44-56, doi:10.1093/schbul/sbu132 (2015).

9 Dazzan, P. _et al._ Magnetic resonance imaging and the prediction of outcome in first-episode schizophrenia: a review of current evidence and directions for future research. _Schizophr Bull_ **41** , 574-583, doi:10.1093/schbul/sbv024 (2015).

10 Glausier, J. R. & Lewis, D. A. Dendritic spine pathology in schizophrenia. _Neuroscience_ **251** , 90-107, doi:10.1016/j.neuroscience.2012.04.044 (2013).

11 Li, Z. _et al._ Genome-wide association analysis identifies 30 new susceptibility loci for schizophrenia. _Nat Genet_ **49** , 1576-1583, doi:10.1038/ng.3973 (2017).

12 Hall, M. H. _et al._ The Early Auditory Gamma-Band Response Is Heritable and a Putative Endophenotype of Schizophrenia. _Schizophrenia Bulletin_ **37** , 778-787, doi:10.1093/schbul/sbp134 (2011).

13 Grutzner, C. _et al._ Deficits in high- (\> 60 Hz) gamma-band oscillations during visual processing in schizophrenia. _Frontiers in Human Neuroscience_ **7** , doi:ARTN 88 10.3389/fnhum.2013.00088 (2013).

14 Rass, O. _et al._ Auditory steady state response in the schizophrenia, first-degree relatives, and schizotypal personality disorder. _Schizophrenia Research_ **136** , 143-149, doi:10.1016/j.schres.2012.01.003 (2012).

15 Leicht, G. _et al._ Reduced Early Auditory Evoked Gamma-Band Response in Patients with Schizophrenia. _Biological Psychiatry_ **67** , 224-231, doi:10.1016/j.biopsych.2009.07.033 (2010).

16 Keil, J., Romero, Y. R., Balz, J., Henjes, M. S. & Senkowski, D. Positive and Negative Symptoms in Schizophrenia Relate to Distinct Oscillatory Signatures of Sensory Gating (vol 10, 104, 2016). _Frontiers in Human Neuroscience_ **10** , doi:ARTN 162 10.3389/fnhum.2016.00162 (2016).

17 Puvvada, K. C. _et al._ Delta Vs Gamma Auditory Steady State Synchrony in Schizophrenia. _Schizophrenia Bulletin_ **44** , 378-387, doi:10.1093/schbul/sbx078 (2018).

18 Ribeiro, T. L. _et al._ Spike avalanches exhibit universal dynamics across the sleep-wake cycle. _PLoS One_ **5** , e14129, doi:10.1371/journal.pone.0014129 (2010).

19 Maier, A., Cox, M. A., Dougherty, K., Moore, B. & Leopold, D. A. Anisotropy of ongoing neural activity in the primate visual cortex. _Eye Brain_ **6** , 113-120, doi:10.2147/EB.S51822 (2014).

20 Srinath, R. & Ray, S. Effect of amplitude correlations on coherence in the local field potential. _J Neurophysiol_ **112** , 741-751, doi:10.1152/jn.00851.2013 (2014).
